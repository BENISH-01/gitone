<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="css/resume_api.css"/>
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <title>Document</title>
</head>
<body id="total_body">
    <form>
        <div class="container_fluid main">
          <h1 class="text-center mb-5">Fill Your Details</h1>
          <label class="label_font ">NAME:</label> <input class="style" id="in" onkeyup="add('name',this.value)"/><br><br>
          <label class="label_font">E-mail:</label> <input  class="style" id="emF" onkeyup="add('email',this.value)"/><br><br>
          <label class="label_font">PHONE:</label><input class="style"  id="phoneF" type="tel" onkeyup="add('phone',this.value)"/><br><br>
          <label class="label_font ">ROLE:</label><input  class="style" id="roleF" onkeyup="add('role',this.value)"/><br><br>
          <label class="label_font ">OBJECTIVE:</label><textarea class="style" id="objF" onkeyup="add('objective',this.value)"></textarea><br><br>
       
          <label class="label_font" >SKILLS:</label>
          <input class="style" type="text" onkeyup="add('skills',this.value,0)"/>
          <input class="style" type="text" onkeyup="add('skills',this.value,1)"/>
          <input class="style" type="text" onkeyup="add('skills',this.value,2)"/><br><br>
       
       
       
         <!-- personal -->
         <label class="label_font">AGE:</label><input class="style"  type="number" onkeyup="add('personal_details',this.value,0,'age')"/><br><br>
         <label class="label_font">MARTIAL_STATUS:</label><input class="style"  type="text" onkeyup="add('personal_details',this.value,1,'martial_status')"/><br><br>
         <label class="label_font">GENDER:</label><input class="style"  type="text" onkeyup="add('personal_details',this.value,2,'gender')"/><br><br>
         <label class="label_font">FATHER'S NAME:</label><input class="style"  type="text" onkeyup="add('personal_details',this.value,3,'father_name')"/><br><br>
         <label class="label_font">ADDRESS:</label><input class="style"  type="text" onkeyup="add('personal_details',this.value,4,'address')"/><br><br>
         
           <!-- languages -->
         <label class="label_font">LANGUAGE:</label><input class="style"  type="text" onkeyup="add('language',this.value,0)"/>
                         <input class="style" type="text" onkeyup="add('language',this.value,1)"/>
                         <input class="style" type="text" onkeyup="add('language',this.value,2)"/><br><br>
                        
       
        <!-- intrsest -->
        <label class="label_font">INTREST:</label><input class="style" type="text" onkeyup="add('intrest',this.value,0)"/>
                                <input class="style" type="text" onkeyup="add('intrest',this.value,1)"/>
                                <input class="style" type="text" onkeyup="add('intrest',this.value,2)"/><br><br>
           
          <!-- hobbies -->
         <label class="label_font">Hobbies:</label><input class="style" type="text" onkeyup="add('hobbies',this.value,0)"/>
                                            <input class="style" type="text" onkeyup="add('hobbies',this.value,1)"/><br><br>
    
          <!-- education -->
          <label class="label_font">EDUCATION:</label>
          <table class="table">
           <thead>
             <tr>
               <th scope="col">#</th>
               <th scope="col">Course</th>
               <th scope="col">Year</th>
               <th scope="col">Institute</th>
               <th scope="col">Percentage</th>
             </tr>
           </thead>
           <tbody>
             <tr>
               <th scope="row">1</th>
               <td><input type="text" onkeyup="add('education',this.value,0,'course')"/></td>
               <td><input type="number" onkeyup="add('education',this.value,0,'year')"/></td>
               <td><input type="text" onkeyup="add('education',this.value,0,'institute')"/></td>
               <td><input type="number" onkeyup="add('education',this.value,0,'percentage')"/></td>
             </tr>
             <tr>
               <th scope="row">2</th>
               <td><input type="text" onkeyup="add('education',this.value,1,'course')"/></td>
               <td> <input type="number" onkeyup="add('education',this.value,1,'year')"/></td>
               <td><input type="text" onkeyup="add('education',this.value,1,'institute')"/></td>
               <td><input type="number" onkeyup="add('education',this.value,1,'percentage')"/></td>
             </tr>
             <tr>
               <th scope="row">3</th>
               <td><input type="text" onkeyup="add('education',this.value,2,'course')"/></td>
               <td> <input type="number" onkeyup="add('education',this.value,2,'year')"/></td>
               <td><input type="text" onkeyup="add('education',this.value,2,'institute')"/></td>
               <td><input type="number" onkeyup="add('education',this.value,2,'percentage')"/></td>
             </tr>
             <tr>
               <th scope="row">4</th>
               <td><input type="text" onkeyup="add('education',this.value,3,'course')"/></td>
               <td> <input type="number" onkeyup="add('education',this.value,3,'year')"/></td>
               <td><input type="text" onkeyup="add('education',this.value,3,'institute')"/></td>
               <td><input type="number" onkeyup="add('education',this.value,3,'percentage')"/></td>
             </tr>
           </tbody>
         </table>
        <!--certification  -->
        <label class="label_font">CERTIFICATION:</label><br><br>
        <table class="table">
           <thead>
             <tr>
               <th scope="col">#</th>
               <th scope="col">course</th>
               <th scope="col">Institute</th>
               <th scope="col">Duration</th>
               
             </tr>
           </thead>
           <tbody>
               <tr>
                   <th scope="row">1</th>
                   <td><input type="text" onkeyup="add('certification',this.value,0,'course')"/></td>
                   <td><input type="text" onkeyup="add('certification',this.value,0,'institute')"/></td>
                   <td><input type="number" onkeyup="add('certification',this.value,0,'duration')"/></td>
                   
                   
               </tr>
               <tr>
                   <th scope="row">2</th>
                   <td><input type="text" onkeyup="add('certification',this.value,1,'course')"/></td>
                   <td><input type="text" onkeyup="add('certification',this.value,1,'institute')"/></td>
                   <td> <input type="number" onkeyup="add('certification',this.value,1,'duration')"/></td>
                  
                   
               </tr>
           </tbody>
        </table><br><br>
        <!-- project -->
        <label class="label_font">PROJECTS:</label>
        <table class="table">
         <thead>
           <tr>
             <th scope="col">#</th>
             <th scope="col">Title</th>
             <th scope="col">Abstract</th>
            
           </tr>
         </thead>
         <tbody>
           <tr>
             <th scope="row">1</th>
             <td><input type="text" onkeyup="add('project',this.value,0,'project_title')"/></td>
             <td><textarea type="text" onkeyup="add('project',this.value,0,'abstract')"></textarea></td>
            
           </tr>
           <tr>
             <th scope="row">2</th>
             <td><input type="text" onkeyup="add('project',this.value,1,'project_title')"/></td>
             <td><textarea type="text" onkeyup="add('project',this.value,1,'abstract')"></textarea></td>
             
           </tr>
          
         </tbody>
       </table><br><br>
       
        <!-- experience -->
        <label class="label_font">EXPERIENCE:</label><br><br>
        
        <table class="table">
           <thead>
             <tr>
               <th scope="col">#</th>
               <th scope="col">Organization</th>
               <th scope="col">Role</th>
               <th scope="col">Working_year</th>
               <th scope="col">Contact_information</th>
             </tr>
           </thead>
           <tbody>
             <tr>
               <th scope="row">1</th>
               <td><input type="text" onkeyup="add('experience',this.value,0,'org')"/></td>
               <td><input type="text" onkeyup="add('experience',this.value,0,'role')"/></td>
               <td><input type="text" onkeyup="add('experience',this.value,0,'work_year')"/></td>
               <td><input type="number" onkeyup="add('experience',this.value,0,'contact_info')"/></td>
             </tr>
             <tr>
               <th scope="row">2</th>
               <td><input type="text" onkeyup="add('experience',this.value,1,'org')"/></td>
               <td> <input type="text" onkeyup="add('experience',this.value,1,'role')"/></td>
               <td><input type="text" onkeyup="add('experience',this.value,1,'work_year')"/></td>
               <td><input type="number" onkeyup="add('experience',this.value,1,'contact_info')"/></td>
             </tr>
           
           </tbody>
         </table><br><br>
       
       
       
          
         
        </div>
        
    
       </form>
       <div class="container-fluid  main main1 p-5">
          <div id="code"></div>
            <button id="submit"  class="btn subbutn btn-primary ">Submit</button>
            <button id="list"  class="btn btn-success listbtn">Get</button>
            <!-- <button id="remove_list"  class="btn btn-danger listbtn">Delete</button> -->
            
          </div>
          <ul id="all_name"></ul>

          <!-- tabel -->
          <table class="table">
            <thead>
              <th>SI.NO</th>
              <th>NAME</th>
              <th>EMAIL</th>
              <th>PHONE</th>
              <th>ACTION</th>
              <th>VIEW</th>
            </thead>
            <tbody id="table_val">
              <tr >

              </tr>

            </tbody>


          </table>


       <!-- script -->
       <script src="https://code.jquery.com/jquery-3.6.1.min.js"
       integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
      crossorigin="anonymous"></script>

       <script>

        let resume={
          
        }

function add(key,value,index=null,indexKey=null){
    if(index==null){
        resume[key]=value;
    }
    else if(key=="education" || key=="certification" || key=="experience" ||key=="project"){
        if(!resume[key]){
            resume[key]=[];
        }
        if(!resume[key][index]){
            resume[key][index]={}

        } 
        
        resume[key][index][indexKey]=value
    }
    else if(key=="personal_details"){
        if(!resume[key]){
            resume[key]={}
          
        }
        resume[key][indexKey]=value;
    }
  

    else if(key=="intrest" || key=="hobbies" || key=="skills" || key=="language"){
        if(!resume[key]){
            resume[key]=[]
        }
        resume[key][index]=value
    }

    

    else{
        resume[key][index]=value;
    }
    
    


}


$(document).ready(function(){
  // table
  $.ajax({
        type:'get',
        url:"http://karka.academy/api/action.php",
        data:{
          request:"get_user_resume",
          user:"benish"
        },
        success:function(data){
          console.log(data)
          data_1=JSON.parse(data)
          console.log(data_1)
          
          let ele=''
          for(let i=0; i<data_1.data.length; i++){ 
            let data_2=JSON.parse(data_1.data[i].data);
            console.log(data_2)
            ele= ele+"<tr>"+"<td>"+parseInt(i+1)+"</td>"+"<td>"+data_2.name+"</td>"+"<td>"+data_2.email+"</td>"+"<td>"+data_2.phone+"</td>"+"<td>"+"<button class='btn btn-primary' id='remove_list' value="+data_1.data[i].id+">"+'Remove'+"</button>"+"</td>"+"<td>"+"<button class='btn btn-success' id='show_res' value="+data_1.data[i].id+">"+'view'+"</button>"+"</td>"+"</tr>"
           
          }
          $("#table_val").append(ele);
        }
  })
  
  // submit
    $("#submit").click(function(){
        $.ajax({
            type:"post",
            url:"http://karka.academy/api/action.php",
            data:{
                request:"create_resume",
                user:"benish",
                resume
                
            },
            success:function(data){
                console.log(data)
            }
            
            
        })
        $.ajax({
        type:'get',
        url:"http://karka.academy/api/action.php",
        data:{
          request:"get_user_resume",
          user:"benish"
        },
        success:function(data){
          console.log(data)
          data_1=JSON.parse(data)
          console.log(data_1)
          
          let ele=''
          for(let i=0; i<data_1.data.length; i++){ 
            let data_2=JSON.parse(data_1.data[i].data);
            console.log(data_2)
            ele= ele+"<tr>"+"<td>"+parseInt(i+1)+"</td>"+"<td>"+data_2.name+"</td>"+"</td>"+"<td>"+data_2.email+"</td>"+"<td>"+data_2.phone+"</td>"+"<td>"+"<button class='btn btn-primary' id='remove_list' value="+data_1.data[i].id+">"+'Remove'+"</button>"+"</td>"+"<td>"+"<button class='btn btn-success' id='show_res' value="+data_1.data[i].id+" >"+'view'+"</button>"+"</td>"+"</tr>"
           console.log(data_1.data[i].id)
           
          }
          $("#table_val").html(ele);
        }
  })
    });
    $("#list").click(function(){
      $.ajax({
        type:'get',
        url:"http://karka.academy/api/action.php",
        data:{
          request:"get_user_resume",
          user:"benish"
        },
        success:function(data){
          console.log(data)
        },
        
      })
    });

    // delete
    $("body").on("click","#remove_list",function(){
      alert("This id will be deleted permenetly")
      let del_id=this.value;
      console.log(del_id)
      $.ajax({
        type:"get",
        url:"http://karka.academy/api/action.php",
        data:{
          request:"delete_user_resume",
          user:"benish",
          id:del_id
      
        },
        success:function(data){
          console.log(data)
          $.ajax({
            type:'get',
            url:"http://karka.academy/api/action.php",
            data:{
              request:"get_user_resume",
              user:"benish"
            },
            success:function(data){
              console.log(data)
              data_1=JSON.parse(data)
              console.log(data_1)
              
              let ele=''
              for(let i=0; i<data_1.data.length; i++){ 
                let data_2=JSON.parse(data_1.data[i].data);
                console.log(data_2)
                ele= ele+"<tr>"+"<td>"+parseInt(i+1)+"</td>"+"<td>"+data_2.name+"</td>"+"</td>"+"<td>"+data_2.email+"</td>"+"<td>"+data_2.phone+"</td>"+"<td>"+"<button class='btn btn-primary' id='remove_list' value="+data_1.data[i].id+">"+'Remove'+"</button>"+"</td>"+"<td>"+"<button class='btn btn-success'id='show_res' value="+data_1.data[i].id+">"+'view'+"</button>"+"</td>"+"</tr>"
              
              }
              $("#table_val").html(ele);
            }
  })
          

        }
      })
    })

  // view
    $("body").on("click","#show_res",function(){
      let needed_res=this.value;
      
      $.ajax({
        type:"get",
        url:"http://karka.academy/api/action.php",
        data:{
          request:"get_resume_by_id",
          user:"benish",
          id:needed_res,
          },
        success:function(data){
             console.log(data)
             
        }

      })
    })


})


</script>
</body>



</html>